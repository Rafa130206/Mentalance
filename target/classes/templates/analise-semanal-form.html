<!DOCTYPE html>
<html lang="pt-BR" xmlns:th="http://www.thymeleaf.org"
      th:replace="fragments/base :: layout(~{::title}, ~{::body})">
<head>
    <title>Nova Análise Semanal</title>
</head>
<body>
<section class="card">
    <h1>Nova Análise Semanal</h1>

    <div th:if="${mensagemErro}" class="alert alert--error" th:text="${mensagemErro}"></div>

    <form th:action="@{/analise-semanal}" th:object="${analise}" method="post">
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
        
        <label for="semanaReferencia">Semana de Referência</label>
        <input type="text" id="semanaReferencia" th:field="*{semanaReferencia}" 
               placeholder="Ex: 2025-W01" 
               pattern="^[0-9]{4}-W[0-9]{2}$"
               required>
        <small style="color: #6B7280; display: block; margin-top: -0.75rem; margin-bottom: 1rem;">
            Formato: YYYY-WNN (ex: 2025-W01, 2025-W52)
        </small>
        <div class="alert alert--error" th:if="${#fields.hasErrors('semanaReferencia')}" th:errors="*{semanaReferencia}"></div>

        <label for="emocaoPredominante">Emoção Predominante</label>
        <input type="text" id="emocaoPredominante" th:field="*{emocaoPredominante}" 
               placeholder="Ex: Feliz, Ansioso, Calmo, Motivado..." 
               maxlength="100" required>
        <div class="alert alert--error" th:if="${#fields.hasErrors('emocaoPredominante')}" th:errors="*{emocaoPredominante}"></div>

        <label for="resumo">Resumo</label>
        <textarea id="resumo" rows="5" th:field="*{resumo}" 
                  placeholder="Descreva um resumo da semana..."
                  maxlength="2000" required></textarea>
        <div class="alert alert--error" th:if="${#fields.hasErrors('resumo')}" th:errors="*{resumo}"></div>

        <label for="recomendacao">Recomendação</label>
        <textarea id="recomendacao" rows="5" th:field="*{recomendacao}" 
                  placeholder="Forneça recomendações baseadas na análise..."
                  maxlength="2000" required></textarea>
        <div class="alert alert--error" th:if="${#fields.hasErrors('recomendacao')}" th:errors="*{recomendacao}"></div>

        <button type="submit">Salvar Análise</button>
        <a th:href="@{/}" style="display: inline-block; margin-left: 1rem; color: var(--primary);">Cancelar</a>
    </form>
</section>
</body>
</html>

